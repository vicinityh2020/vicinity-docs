

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>VICINITY Neighbourhood Manager &mdash; VICINITY Get Started 0.6.2 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="VICINITY Vocabulary" href="vocabulary.html" />
    <link rel="prev" title="VICINITY Overall architecture" href="architecture.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> VICINITY Get Started
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="architecture.html">VICINITY Overall architecture</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">VICINITY Neighbourhood Manager</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#platform-deployment">Platform deployment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pre-requisites">Pre-requisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-the-web-application">Get the web application</a></li>
<li class="toctree-l3"><a class="reference internal" href="#install-and-configure-mongo-db">Install and configure Mongo DB</a></li>
<li class="toctree-l3"><a class="reference internal" href="#run-the-client">Run the client</a></li>
<li class="toctree-l3"><a class="reference internal" href="#run-the-server">Run the server</a></li>
<li class="toctree-l3"><a class="reference internal" href="#putting-all-together-first-user-and-organisation-in-the-app">Putting all together – First user and organisation in the app</a></li>
<li class="toctree-l3"><a class="reference internal" href="#old">Old</a></li>
<li class="toctree-l3"><a class="reference internal" href="#optional">OPTIONAL</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#platform-introduction">Platform Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#architecture">Architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="#platform-overview">Platform Overview</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#login">Login</a></li>
<li class="toctree-l4"><a class="reference internal" href="#registration">Registration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#home">Home</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#quick-start">Quick Start</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">Pre-requisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="#first-login">First login</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-an-access-point">Create an access point</a></li>
<li class="toctree-l4"><a class="reference internal" href="#next-steps">Next steps</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id4">Registration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#register-an-organisation">Register an organisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#invite-an-organisation-or-user">Invite an organisation or user</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#invite-a-new-organisation">Invite a new organisation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#invite-a-new-user-under-your-organisation">Invite a new user under your organisation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#quick-registration-for-api-developers">Quick registration for API developers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#organisation-and-user-management">Organisation and user management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#organisation-properties">Organisation properties</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#properties">Properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="#relationships">Relationships</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#user-properties-and-roles">User properties and roles</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id5">Properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">Relationships</a></li>
<li class="toctree-l4"><a class="reference internal" href="#roles">Roles</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#organisation-management">Organisation management</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#organisations-view">Organisations view</a></li>
<li class="toctree-l4"><a class="reference internal" href="#friendships">Friendships</a></li>
<li class="toctree-l4"><a class="reference internal" href="#remove-organisation">Remove organisation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#user-management">User management</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#remove-user">Remove user</a></li>
<li class="toctree-l4"><a class="reference internal" href="#change-roles">Change roles</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#infrastructure-management">Infrastructure Management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#access-points">Access Points</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id8">Properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9">Relationships</a></li>
<li class="toctree-l4"><a class="reference internal" href="#manage">Manage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#items">Items</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id10">Properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id11">Relationships</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id12">Manage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#status-visibility">Status &amp; visibility</a></li>
<li class="toctree-l4"><a class="reference internal" href="#move-an-item">Move an item</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#contracts">Contracts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id15">Properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id16">Relationships</a></li>
<li class="toctree-l4"><a class="reference internal" href="#main-views">Main views</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id17">Manage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#update-items-in-the-contract">Update items in the contract</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#platform-evaluation">Platform Evaluation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tests">Tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="#complexity">Complexity</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#f-a-q">F.A.Q</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#how-can-i-recover-my-password">How can I recover my password?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-can-i-change-my-password">How can I change my password?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#can-i-keep-a-session-open-in-my-browser">Can I keep a session open in my browser?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-can-i-use-the-platform-rest-api">How can I use the platform REST API?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="vocabulary.html">VICINITY Vocabulary</a></li>
<li class="toctree-l1"><a class="reference internal" href="getstarted.html">Get started</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">VICINITY Get Started</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>VICINITY Neighbourhood Manager</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/neighbourhood.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="vicinity-neighbourhood-manager">
<h1>VICINITY Neighbourhood Manager<a class="headerlink" href="#vicinity-neighbourhood-manager" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<img alt="_images/img-vicinity.png" class="align-center" src="_images/img-vicinity.png" />
<p>VICINITY Neighbourhood Manager is a web-based application that creates a platform for users an their IoT infrastructures with an intuitive visual control. The users can contract added-value services that can access their devices connected to the VICINITY Platform to collect data and control them.</p>
<p>In VICINITY Neighbourhood Manager, as in regular social networks, it is possible to establish partnerships with other users and gain read or control access to their devices.</p>
<p>The users can set privacy levels to each device and service they have registered in VICINITY. The privacy levels range from:</p>
<ul class="simple">
<li>Private – Visible only within the user organisation.</li>
<li>Visible for friends – Visible also for organisations that were befriended.</li>
<li>Public -  Visible for the whole platform.</li>
</ul>
<p>In order to register device and service user needs to create so called gateway and set-up VICINITY Gateway and VICINITY Adapter to connect his devices and services to VICINITY Platform. To set-up VICINITY Gateway and VICINITY Adapter please consult following repositories:</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/vicinityh2020/vicinity-agent">VICINITY Agent</a></li>
<li><a class="reference external" href="https://vicinityh2020.github.io/vicinity-gateway-api/">VICINITY Gateway API</a></li>
<li><a class="reference external" href="https://vicinityh2020.github.io/vicinity-neighbourhood-manager-api/">VICINITY Neighbourhood Manager API</a></li>
</ul>
<p>VICINITY Neighbourhood Manager is publicly accessible on: <a class="reference external" href="https://vicinity.bavenir.eu">https://vicinity.bavenir.eu</a></p>
</div>
<hr class="docutils" />
<div class="section" id="platform-deployment">
<h2>Platform deployment<a class="headerlink" href="#platform-deployment" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Linux machine. Tested in Debian Jessie and Ubuntu</p>
</div>
<p>If you are interested to deploy private instance of VICINITY Neighbourhood Manager please follow the following guideline.
In case you just want to make use of the platform please proceed to the next section of the wiki.</p>
<div class="section" id="pre-requisites">
<h3>Pre-requisites<a class="headerlink" href="#pre-requisites" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>GIT: <a class="reference external" href="https://git-scm.com/">https://git-scm.com/</a></li>
<li>NodeJS: <a class="reference external" href="http://nodejs.org/">http://nodejs.org/</a></li>
</ul>
</div>
<div class="section" id="get-the-web-application">
<h3>Get the web application<a class="headerlink" href="#get-the-web-application" title="Permalink to this headline">¶</a></h3>
<p><strong>Create and navigate to the folder where the repository should be cloned:</strong></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span>
<span class="n">cd</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>Clone the repository and rename the folder:</strong></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">jalmela</span><span class="nd">@bitbucket</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">bavenir</span><span class="o">/</span><span class="n">vicinity</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>Point the webApp to the API URL:</strong></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">vicinity</span><span class="o">/</span><span class="n">vicinityManager</span><span class="o">/</span><span class="n">client</span><span class="o">/</span><span class="n">app</span>
<span class="n">sudo</span> <span class="n">vim</span> <span class="n">env</span><span class="o">.</span><span class="n">js</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>Comment all the lines except the first</li>
<li>Add at the bottom: this.env.apiUrl = “<a class="reference external" href="http:/">http:/</a>/&lt;IP&gt;:&lt;PORT&gt;”</li>
</ul>
</div>
<div class="section" id="install-and-configure-mongo-db">
<h3>Install and configure Mongo DB<a class="headerlink" href="#install-and-configure-mongo-db" title="Permalink to this headline">¶</a></h3>
<p><strong>Install</strong></p>
<ol class="arabic simple">
<li>Import they key for the official MongoDB repository.</li>
</ol>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">key</span> <span class="n">adv</span> <span class="o">--</span><span class="n">keyserver</span> <span class="n">hkp</span><span class="p">:</span><span class="o">//</span><span class="n">keyserver</span><span class="o">.</span><span class="n">ubuntu</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="mi">80</span> <span class="o">--</span><span class="n">recv</span> <span class="mi">0</span><span class="n">C49F3730359A14518585931BC711F9BA15703C6</span>
</pre></div>
</div>
</div></blockquote>
<ol class="arabic simple" start="2">
<li>After successfully importing the key, you will see:</li>
</ol>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Output</span>
<span class="n">gpg</span><span class="p">:</span> <span class="n">Total</span> <span class="n">number</span> <span class="n">processed</span><span class="p">:</span> <span class="mi">1</span>
<span class="n">gpg</span><span class="p">:</span>               <span class="n">imported</span><span class="p">:</span> <span class="mi">1</span>  <span class="p">(</span><span class="n">RSA</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<ol class="arabic" start="3">
<li><p class="first">Next, we have to add the MongoDB repository details so apt will know where to download the packages from. Issue the following command to create a list file for MongoDB.</p>
<blockquote>
<div><ul class="simple">
<li>WARNING: It may change depending on the Linux distribution</li>
<li>echo “deb <a class="reference external" href="http://repo.mongodb.org/apt/debian">http://repo.mongodb.org/apt/debian</a> jessie/mongodb-org/3.4 main” | sudo tee /etc/apt/sources.list.d/mongodb-org-3.4.list</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">After adding the repository details, update the packages list and install the MongoDB package.</p>
</li>
</ol>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">update</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">mongodb</span><span class="o">-</span><span class="n">org</span>
</pre></div>
</div>
</div></blockquote>
<ol class="arabic simple" start="5">
<li>Create target folders for mongo and give permissions to the mongo user on that folders.</li>
</ol>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">db</span>
<span class="n">chown</span> <span class="o">-</span><span class="n">R</span> <span class="n">mongodb</span><span class="p">:</span><span class="n">mongodb</span> <span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">db</span>
<span class="n">chown</span> <span class="o">-</span><span class="n">R</span> <span class="n">mongodb</span><span class="p">:</span><span class="n">mongodb</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">mongodb</span>
</pre></div>
</div>
</div></blockquote>
<ol class="arabic simple" start="6">
<li>Set paths in configuration file (/etc/mongod.conf) to:<ul>
<li>Storage –&gt; dbPath: /data/db</li>
<li>SystemLog –&gt; path: /var/log/mongodb/mongod.log</li>
</ul>
</li>
</ol>
<blockquote>
<div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">See at the end how to add users to MONGO if you want to use authorization for security</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">BE CAREFUL WITH THE SPACES – YAML FORMAT</p>
</div>
</div></blockquote>
<ol class="arabic simple" start="7">
<li>Once MongoDB installs, start the service, and ensure it starts when your server reboots:</li>
</ol>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">enable</span> <span class="n">mongod</span><span class="o">.</span><span class="n">service</span>
<span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">start</span> <span class="n">mongod</span>
<span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">status</span> <span class="n">mongod</span>  <span class="p">(</span><span class="n">Check</span> <span class="n">it</span> <span class="n">runs</span> <span class="n">properly</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="run-the-client">
<h3>Run the client<a class="headerlink" href="#run-the-client" title="Permalink to this headline">¶</a></h3>
<p><strong>Install Angular Web App</strong></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">npm</span> <span class="n">install</span> <span class="o">-</span><span class="n">g</span> <span class="n">bower</span>
<span class="n">cd</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">vicinity</span><span class="o">/</span><span class="n">vicinityManager</span><span class="o">/</span><span class="n">client</span>
<span class="n">sudo</span> <span class="n">bower</span> <span class="n">install</span> <span class="o">--</span><span class="n">allow</span><span class="o">-</span><span class="n">root</span>
<span class="n">sudo</span> <span class="n">npm</span> <span class="n">install</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>Install Apache</strong></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">apache2</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>Configure apache</strong></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">apache2</span><span class="o">/</span><span class="n">sites</span><span class="o">-</span><span class="n">available</span>
<span class="n">sudo</span> <span class="n">touch</span> <span class="p">[</span><span class="n">server</span><span class="o">-</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">conf</span>
</pre></div>
</div>
</div></blockquote>
<ul>
<li><p class="first">Create conf:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;VirtualHost *:80&gt;
        ServerName [server name]
        ServerAdmin [admin mail]
        DocumentRoot [location of your index file]
        ErrorLog ${APACHE_LOG_DIR}/error.log
        CustomLog ${APACHE_LOG_DIR}/access.log combined
        Redirect permanent / [server name]
&lt;/VirtualHost&gt;
&lt;IfModule mod_ssl.c&gt;
        &lt;VirtualHost _default_:443&gt;
                ServerAdmin [admin mail]
                DocumentRoot [location of your index file]
                ErrorLog ${APACHE_LOG_DIR}/error.log
                CustomLog ${APACHE_LOG_DIR}/access.log combined
                SSLEngine on
                #   A self-signed (snakeoil) certificate can be created by installing
                #   the ssl-cert package. See
                #   /usr/share/doc/apache2/README.Debian.gz for more info.
                #   If both key and certificate are stored in the same file, only the
                #   SSLCertificateFile directive is needed.
                SSLCertificateFile      [ cert file ]
                SSLCertificateKeyFile   [ key file ]
                &lt;FilesMatch &quot;\.(cgi|shtml|phtml|php)$&quot;&gt;
                                SSLOptions +StdEnvVars
                &lt;/FilesMatch&gt;
                &lt;Directory /usr/lib/cgi-bin&gt;
                                SSLOptions +StdEnvVars
                &lt;/Directory&gt;
                BrowserMatch &quot;MSIE [2-6]&quot; \
                                nokeepalive ssl-unclean-shutdown \
                                downgrade-1.0 force-response-1.0
                # MSIE 7 and newer should be able to use keepalive
                BrowserMatch &quot;MSIE [17-9]&quot; ssl-unclean-shutdown
        &lt;/VirtualHost&gt;
&lt;/IfModule&gt;
</pre></div>
</div>
</li>
<li><p class="first">Save your conf file</p>
</li>
<li><p class="first">Disable default site</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">a2dissite</span> <span class="mi">000</span><span class="o">-</span><span class="n">default</span><span class="o">.</span><span class="n">conf</span>
</pre></div>
</div>
</li>
<li><p class="first">Enable your site</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">a2ensite</span> <span class="p">[</span><span class="n">your</span> <span class="n">server</span><span class="p">]</span><span class="o">.</span><span class="n">conf</span>
</pre></div>
</div>
</li>
<li><p class="first">Enable SSL</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">a2enmod</span> <span class="n">ssl</span>
</pre></div>
</div>
</li>
<li><p class="first">Start the service</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">service</span> <span class="n">apache2</span> <span class="n">start</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="run-the-server">
<h3>Run the server<a class="headerlink" href="#run-the-server" title="Permalink to this headline">¶</a></h3>
<p><strong>Install Node JS app</strong></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">vicinity</span><span class="o">/</span><span class="n">vicinityManager</span><span class="o">/</span><span class="n">server</span>
<span class="n">sudo</span> <span class="n">npm</span> <span class="n">install</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>Install forever</strong></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span>npm install –g forever
sudo mkdir /var/run/forever
</pre></div>
</div>
</div></blockquote>
<p><strong>Create a service</strong></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">touch</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">vcnt_server</span>
<span class="n">sudo</span> <span class="n">chmod</span> <span class="n">a</span><span class="o">+</span><span class="n">x</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">vcnt_server</span>
<span class="n">sudo</span> <span class="n">update</span><span class="o">-</span><span class="n">rc</span><span class="o">.</span><span class="n">d</span> <span class="n">vcnt_server</span> <span class="n">defaults</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>Script</strong></p>
<ul>
<li><p class="first">Update environmental variables within the script below. Use the corrensponding information for your deployment.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/bash
### BEGIN INIT INFO
# If you wish the Daemon to be lauched at boot / stopped at shutdown :
#
#    On Debian-based distributions:
#      INSTALL : update-rc.d scriptname defaults
#      (UNINSTALL : update-rc.d -f  scriptname remove)
#
#    On RedHat-based distributions (CentOS, OpenSUSE...):
#      INSTALL : chkconfig --level 35 scriptname on
#      (UNINSTALL : chkconfig --level 35 scriptname off)
#
# chkconfig:         2345 90 60
# Provides:          /var/www/html/vicinity/vicinityManager/server/bin/www
# Required-Start:    $remote_fs $syslog
# Required-Stop:     $remote_fs $syslog
# Default-Start:     2 3 4 5
# Default-Stop:      0 1 6
# Short-Description: forever running /var/www/vicinity/vicinityManager/server/bin/www
# Description:       /var/www/html/vicinity/vicinityManager/server/bin/www
### END INIT INFO
#
# initd a node app
# Based on a script posted by https://gist.github.com/jinze at https://gist.github.com/3748766
#
if [ -e /lib/lsb/init-functions ]; then
    # LSB source function library.
    . /lib/lsb/init-functions
fi;
pidFile=&quot;/var/log/vicinity/vcnt_server.pid&quot;
logFile=&quot;/var/log/vicinity/vcnt_server.log&quot;
outFile=&quot;/var/log/vicinity/vcnt_server.out&quot;
errFile=&quot;/var/log/vicinity/vcnt_server.err&quot;
command=&quot;node&quot;
nodeApp=&quot;/var/www/html/vicinity/vicinityManager/server/bin/www&quot;
foreverApp=&quot;forever&quot;
### EXPORT environmental variables
# PORT
export PORT={port}
# MONGO DB URL
# export VCNT_MNGR_DB=&quot;mongodb://[name]:[pwd]@[IP or localhost]:[port]/vicinity_neighbourhood_manager
export VCNT_MNGR_DB=&quot;mongodb://localhost:27017/vicinity_neighbourhood_manager&quot;
# Comm Server URL and token
export commServerToken={user:password}
export commServerUrl={url}
# JWT Token secret
export jwtTokenSecret={secret key}
# Semantic Repository URL
export semanticRepoUrl={url}
export enabledAdapters={semantic repo adapters}
# SMTP configuration
export smtpHost={host}
export smtpUser={mail}
export smtpPassword={password}
export mailServer={mail}
export approverMail={mail}
# Certificates
export cert={certificate}
export key={private key}
start() {
   echo &quot;Starting $nodeApp&quot;
   # Notice that we change the PATH because on reboot
   # the PATH does not include the path to node.
   # Launching forever with a full path
   # does not work unless we set the PATH.
   PATH=/usr/local/bin:$PATH
    export NODE_ENV=production
   PORT=$PORT VCNT_MNGR_DB=$VCNT_MNGR_DB $foreverApp start --pidFile $pidFile -l $logFile -o $outFile -e $errFile -a -d -c &quot;$command&quot; $nodeApp
   RETVAL=$?
}
restart() {
    echo -n &quot;Restarting $nodeApp&quot;
    $foreverApp restart $nodeApp
    RETVAL=$?
}
stop() {
    echo -n &quot;Shutting down $nodeApp&quot;
   $foreverApp stop $nodeApp
   RETVAL=$?
}
status() {
   echo -n &quot;Status $nodeApp&quot;
   $foreverApp list
   RETVAL=$?
}
case &quot;$1&quot; in
   start)
        start
        ;;
    stop)
        stop
        ;;
   status)
        status
       ;;
   restart)
    restart
        ;;
    *)
       echo &quot;Usage:  {start|stop|status|restart}&quot;
       exit 1
        ;;
esac
exit $RETVAL
</pre></div>
</div>
</li>
</ul>
<p><strong>Run service</strong></p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">mkdir</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">vicinity</span>
<span class="n">sudo</span> <span class="n">touch</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">vicinity</span><span class="o">/</span><span class="n">vcnt_server</span><span class="o">.</span><span class="n">out</span>
<span class="n">sudo</span> <span class="n">touch</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">vicinity</span><span class="o">/</span><span class="n">vcnt_server</span><span class="o">.</span><span class="n">log</span>
<span class="n">sudo</span> <span class="n">touch</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">vicinity</span><span class="o">/</span><span class="n">vcnt_server</span><span class="o">.</span><span class="n">pid</span>
<span class="n">sudo</span> <span class="n">touch</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">vicinity</span><span class="o">/</span><span class="n">vcnt_server</span><span class="o">.</span><span class="n">err</span>
<span class="n">sudo</span> <span class="n">service</span> <span class="n">vcnt_server</span> <span class="n">start</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="putting-all-together-first-user-and-organisation-in-the-app">
<h3>Putting all together – First user and organisation in the app<a class="headerlink" href="#putting-all-together-first-user-and-organisation-in-the-app" title="Permalink to this headline">¶</a></h3>
<p><strong>To start using the web app we need to create the first user manually</strong></p>
<ul>
<li><p class="first">Basic set up</p>
<blockquote>
<div><ul class="simple">
<li>Create dB vicinity_neighbourhood_manager in Mongo</li>
<li>Create the collections user and useraccounts</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Insert first organisation in Mongo – In the useraccount collection</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">db</span><span class="o">.</span> <span class="n">useraccounts</span><span class="o">.</span><span class="n">insert</span><span class="p">({</span>
    <span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;admin&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cid&quot;</span> <span class="p">:</span> <span class="s2">&quot;admin&quot;</span><span class="p">,</span>
    <span class="s2">&quot;businessId&quot;</span> <span class="p">:</span> <span class="s2">&quot;00000000&quot;</span><span class="p">,</span>
    <span class="s2">&quot;skinColor&quot;</span> <span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="s2">&quot;location&quot;</span> <span class="p">:</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span>
    <span class="s2">&quot;status&quot;</span> <span class="p">:</span> <span class="s2">&quot;active&quot;</span>
<span class="p">})</span>
</pre></div>
</div>
</li>
<li><p class="first">Find organisation and copy the Mongo Id</p>
<blockquote>
<div><ul class="simple">
<li>db.useraccounts.find({organisation: organisationName}).pretty()</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Insert first user – In the user collection</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">db</span><span class="o">.</span><span class="n">users</span><span class="o">.</span><span class="n">insert</span><span class="p">({</span>
    <span class="s2">&quot;email&quot;</span> <span class="p">:</span> <span class="s2">&quot;admin@admin.com&quot;</span><span class="p">,</span>
    <span class="s2">&quot;occupation&quot;</span> <span class="p">:</span> <span class="s2">&quot;admin&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;admin&quot;</span><span class="p">,</span>
    <span class="s2">&quot;location&quot;</span> <span class="p">:</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span>
    <span class="s2">&quot;authentication&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;hash&quot;</span> <span class="p">:</span> <span class="n">REQUEST</span> <span class="n">FIRST</span> <span class="n">PASSWORD</span> <span class="n">TO</span> <span class="n">BAVENIR</span><span class="p">,</span>
        <span class="s2">&quot;principalRoles&quot;</span> <span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;user&quot;</span><span class="p">,</span>
            <span class="s2">&quot;devOps&quot;</span><span class="p">,</span>
            <span class="s2">&quot;administrator&quot;</span>
        <span class="p">]</span>
    <span class="p">},</span>
    <span class="s2">&quot;accessLevel&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;cid&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;id&quot;</span> <span class="p">:</span> <span class="o">&lt;</span> <span class="n">organisation</span> <span class="n">MongoId</span> <span class="o">&gt;</span><span class="p">,</span>
        <span class="s2">&quot;extid&quot;</span> <span class="p">:</span> <span class="s2">&quot;admin&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;status&quot;</span> <span class="p">:</span> <span class="s2">&quot;active&quot;</span>
  <span class="p">}</span>
<span class="p">})</span>
</pre></div>
</div>
</li>
<li><p class="first">Add your new user to the organisation</p>
<blockquote>
<div><ul class="simple">
<li>db.useraccounts.update({‘organisation’: organisationName},{‘accountOf’: { $push:{‘id’: &lt; user MongoId &gt;, ‘extid’: “<a class="reference external" href="mailto:admin&#37;&#52;&#48;admin&#46;com">admin<span>&#64;</span>admin<span>&#46;</span>com</a>” }}})</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Try to log in</p>
<blockquote>
<div><ul class="simple">
<li>Navigate your browser to the app domain and use the mail and password to do the first log in.</li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="old">
<h3>Old<a class="headerlink" href="#old" title="Permalink to this headline">¶</a></h3>
<p><strong>Server configuration using NGINX</strong></p>
<ol class="arabic simple">
<li>Install NGINX – <a class="reference external" href="https://www.nginx.com/resources/wiki/start/">https://www.nginx.com/resources/wiki/start/</a></li>
</ol>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">update</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">upgrade</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">nginx</span>
</pre></div>
</div>
</div></blockquote>
<ol class="arabic" start="2">
<li><p class="first">Configure NGINX</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="https://www.linode.com/docs/web-servers/nginx/how-to-configure-nginx">https://www.linode.com/docs/web-servers/nginx/how-to-configure-nginx</a></li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Backup the old configuration</p>
</li>
</ol>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cp</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">nginx</span><span class="o">.</span><span class="n">conf</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">nginx</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">backup</span>
<span class="n">sudo</span> <span class="n">service</span> <span class="n">nginx</span> <span class="n">reload</span>
</pre></div>
</div>
</div></blockquote>
<ol class="arabic simple" start="4">
<li>Create server files and paste the script below</li>
</ol>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">touch</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">sites</span><span class="o">-</span><span class="n">available</span><span class="o">/</span><span class="n">vicinity</span>
<span class="n">sudo</span> <span class="n">touch</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">sites</span><span class="o">-</span><span class="n">enabled</span><span class="o">/</span><span class="n">vicinity</span>
</pre></div>
</div>
</div></blockquote>
<ol class="arabic simple" start="5">
<li>Script vicinity</li>
</ol>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span>server {
listen 80 default_server;
listen [::]:80 default_server;

root /var/www/vicinity/vicinityManager/client/app;

# Add index.php to the list if you are using PHP
index index.html index.htm index.nginx-debian.html;

server_name _;

  location / {
  # First attempt to serve request as file, then
  # as directory, then fall back to displaying a 404.
  try_files $uri $uri/ =404;
  }
}
</pre></div>
</div>
</div></blockquote>
<ol class="arabic simple" start="6">
<li>Run the service</li>
</ol>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">rm</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">sites</span><span class="o">-</span><span class="n">enabled</span><span class="o">/</span><span class="n">default</span>
<span class="n">sudo</span> <span class="n">service</span> <span class="n">nginx</span> <span class="n">restart</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="optional">
<h3>OPTIONAL<a class="headerlink" href="#optional" title="Permalink to this headline">¶</a></h3>
<p><strong>Add authentication to MONGO</strong></p>
<ol class="arabic">
<li><p class="first">Create admin user</p>
<blockquote>
<div><ul class="simple">
<li>mongo</li>
<li>Now in mongo CLI…</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">use</span> <span class="n">admin</span>
</pre></div>
</div>
<ul class="simple">
<li>Create admin …</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">db</span><span class="o">.</span><span class="n">createUser</span><span class="p">({</span>
   <span class="n">user</span><span class="p">:</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span>
   <span class="n">pwd</span><span class="p">:</span> <span class="s2">&quot;pwd&quot;</span><span class="p">,</span>
   <span class="n">roles</span> <span class="p">:</span> <span class="p">[{</span>
        <span class="n">role</span> <span class="p">:</span> <span class="s2">&quot;userAdminAnyDatabase&quot;</span><span class="p">,</span>
        <span class="n">db</span> <span class="p">:</span> <span class="s2">&quot;admin&quot;</span>
   <span class="p">}]</span>
<span class="p">})</span>
</pre></div>
</div>
<ul class="simple">
<li>Close the CLI…</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">quit</span><span class="p">()</span>
</pre></div>
</div>
<ul class="simple">
<li>mongo -u [user] -p [pwd] –authenticationDatabase “admin”</li>
<li>Again in the CLI</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">use</span> <span class="n">vicinity_neighbourhood_manager</span>
</pre></div>
</div>
<ul class="simple">
<li>Create user …</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">db</span><span class="o">.</span><span class="n">createUser</span><span class="p">({</span>
   <span class="n">user</span><span class="p">:</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span>
   <span class="n">pwd</span><span class="p">:</span> <span class="s2">&quot;pwd&quot;</span><span class="p">,</span>
   <span class="n">roles</span> <span class="p">:</span> <span class="p">[{</span>
        <span class="n">role</span> <span class="p">:</span> <span class="s2">&quot;readWrite&quot;</span><span class="p">,</span>
        <span class="n">db</span> <span class="p">:</span> <span class="s2">&quot;vicinity_neighbourhood_manager&quot;</span>
     <span class="p">}]</span>
  <span class="p">})</span>
</pre></div>
</div>
<ul class="simple">
<li>Close CLI</li>
<li>vim /etc/mongod.conf</li>
<li>Add or uncomment</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">security</span>
  <span class="n">authorization</span><span class="p">:</span> <span class="s1">&#39;enabled&#39;</span>
</pre></div>
</div>
<ul class="simple">
<li>Save file</li>
<li>sudo service mongod restart</li>
<li>Remember to update /etc/init.d/vcnt_server with the new MONGO connection string with authentication. Just uncomment and complete the URL that has user and password</li>
</ul>
</div></blockquote>
</li>
</ol>
</div>
</div>
<hr class="docutils" />
<div class="section" id="platform-introduction">
<h2>Platform Introduction<a class="headerlink" href="#platform-introduction" title="Permalink to this headline">¶</a></h2>
<p>This section introduces the platform to new users. It goes through the UI presenting the basic actions and also explains how the app parts interact.</p>
<hr class="docutils" />
<div class="section" id="architecture">
<h3>Architecture<a class="headerlink" href="#architecture" title="Permalink to this headline">¶</a></h3>
<p>In this section it is explained the structure of the web application. All the entities or building blocks that conform the app are presented individually and in relation to the others.</p>
<p>The backbone entities are 5, listed in order of importance below:</p>
<ul class="simple">
<li>Organisation: This is any company or association that own a smart energy facility and it is registered in the platform. An organisation can have many users and gateways underneath.</li>
<li><dl class="first docutils">
<dt>User: These are actors, members of an organisation, that have a profile in the platform. Users can play different roles:</dt>
<dd><ul class="first last">
<li>Device owner</li>
<li>Service provider</li>
<li>Infrastructure operator</li>
<li>Administrator</li>
<li>System integrator</li>
<li>User</li>
</ul>
</dd>
</dl>
</li>
<li>Gateway: It is an entity that represents a Gateway/Adapter. Adapters integrate a IoT infrastructure that contain one or more devices/services. In the platform, each adapter registers its own infrastructure.</li>
<li>Item: It represents all devices and services.</li>
<li>Contract: Every time an organisation requests to use a third party service for its devices, it is necessary to establish a contract between them. This entity stores the legal text, the ids of the parties involved and other relevant information to ensure a correct exchange of data.</li>
</ul>
<p>To complement the social features of the platform there are other 2 entities for the notifications and the audit logs (History).</p>
<p>The relation between entities can be seen in the following picture:</p>
<img alt="_images/img-architecture.png" class="align-center" src="_images/img-architecture.png" />
</div>
<hr class="docutils" />
<div class="section" id="platform-overview">
<h3>Platform Overview<a class="headerlink" href="#platform-overview" title="Permalink to this headline">¶</a></h3>
<p>This section covers the appearance of the web application, we will go through the main views and provide a general description.
The objective is to just to give some orientation to the future users, in the following sections we will drill down into each part of the web.</p>
<div class="section" id="login">
<h4>Login<a class="headerlink" href="#login" title="Permalink to this headline">¶</a></h4>
<p>After providing a valid mail and password it will log you in the web app.</p>
<ul class="simple">
<li>Link to the Vicinity project site.</li>
<li>Login area. You have the option to see your password and to remember the login information in your browser.</li>
<li>Changes the view to registration of a new organisation or to recover your password.</li>
</ul>
<img alt="_images/img-login2.png" class="align-center" src="_images/img-login2.png" />
</div>
<div class="section" id="registration">
<h4>Registration<a class="headerlink" href="#registration" title="Permalink to this headline">¶</a></h4>
<p>Here you can register a new organisation. After filling all the boxes, you will need to wait until the webmaster approves your request. Then you will receive a mail to validate the registration. Shares the navigation options and the background with the login.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All fields are mandatory.</p>
</div>
<img alt="_images/img-register.png" class="align-center" src="_images/img-register.png" />
</div>
<div class="section" id="home">
<h4>Home<a class="headerlink" href="#home" title="Permalink to this headline">¶</a></h4>
<p>Main app view. The central part will show the current selection, being the default view your devices.</p>
<ul class="simple">
<li>Link to your company profile.</li>
<li>Navigation menu: You can switch here between the different parts of your infrastructure like devices, services and also other organisations in your neighbourhood. Other options like gateways, registration requests and contracts will be available or not depending on your user roles.</li>
<li>Top menu: Here you can perform a search by name in the whole neighbourhood, see your notifications, see your user profile and invite other users and organisations to the platform.</li>
</ul>
<img alt="_images/img-home.png" class="align-center" src="_images/img-home.png" />
</div>
</div>
<hr class="docutils" />
<div class="section" id="quick-start">
<h3>Quick Start<a class="headerlink" href="#quick-start" title="Permalink to this headline">¶</a></h3>
<p>This section contains the first steps that any new user should follow to start working with the platform.
The objective is to provide some guidance to non-experienced users of the platform that want to have a quick functional set-up.</p>
<div class="section" id="id1">
<h4>Pre-requisites<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>You have successfully <a class="reference external" href="https://github.com/vicinityh2020/vicinity-neighbourhood-manager/wiki/Register-organisation">registered</a> a new organisation.</li>
</ul>
</div>
<div class="section" id="first-login">
<h4>First login<a class="headerlink" href="#first-login" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>The first time you login, your organisation has only one user with the administrator role. There are no access points, devices or services available at this point.</li>
<li>Go to the organisation profile and <a class="reference external" href="https://github.com/vicinityh2020/vicinity-neighbourhood-manager/wiki/User-management">give new roles to your user</a>. For simplicity, grant all the roles and you will get full power over your organisation. It is possible to have different users having different roles and responsibilities, to learn more go to the <a class="reference external" href="https://github.com/vicinityh2020/vicinity-neighbourhood-manager/wiki/User-properties">user properties section</a>.</li>
<li>As an optional step, making your user visible to others in the platform is a good idea. The reason is that in future steps it will be necessary for making devices and services visible in the platform.</li>
<li>Log-out and log-in again, so the change of roles will take effect.</li>
</ul>
</div>
<div class="section" id="create-an-access-point">
<h4>Create an access point<a class="headerlink" href="#create-an-access-point" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>In order to be able to register devices and services, it is necessary to have access credentials for your agent/adapter. This is what we call <a class="reference external" href="https://github.com/vicinityh2020/vicinity-neighbourhood-manager/wiki/Access-points">access point</a> in the platform.</li>
</ul>
</div>
<div class="section" id="next-steps">
<h4>Next steps<a class="headerlink" href="#next-steps" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>Congratulations, your account is ready to register devices and/or services. If you have not done so yet, install the agent/adapter and a gateway so your infrastructure can communicate with the platform. The access point credentials will be necessary to register your agent and afterwards, for registering devices and services.</li>
<li><dl class="first docutils">
<dt>For more info:</dt>
<dd><ul class="first last">
<li><a class="reference external" href="https://github.com/vicinityh2020/vicinity-agent">VICINITY Agent</a></li>
<li><a class="reference external" href="https://github.com/vicinityh2020/vicinity-gateway-api/tree/master/doc/Integrator%20handbook">VICINITY Gateway API</a></li>
</ul>
</dd>
</dl>
</li>
</ul>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="id4">
<h2>Registration<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>This section covers the possible ways to register an organisation or a user in the platform. In general it is possible to proactively request access, that would require to wait upon validation from the platform admin, or to be invited by an already existing organisation.</p>
<hr class="docutils" />
<div class="section" id="register-an-organisation">
<h3>Register an organisation<a class="headerlink" href="#register-an-organisation" title="Permalink to this headline">¶</a></h3>
<p>This is the basic registration for new organisations interested in joining the IoT platform. It requires to follow some steps that are described below:</p>
<ol class="arabic simple">
<li>Select “Register new company” in the login page.</li>
</ol>
<img alt="_images/img-register-process.png" class="align-center" src="_images/img-register-process.png" />
<ol class="arabic simple" start="2">
<li>The platform administrator will receive your request and validate it.</li>
<li>You will receive a mail stating whether your request was accepted or rejected. If accepted you need to click the validate button.</li>
</ol>
<ul class="simple">
<li>Accept</li>
</ul>
<img alt="_images/img-register-accept.png" class="align-center" src="_images/img-register-accept.png" />
<ul class="simple">
<li>Reject</li>
</ul>
<img alt="_images/img-register-reject.png" class="align-center" src="_images/img-register-reject.png" />
<ol class="arabic simple" start="4">
<li>You will be navigated to the browser and prompted with a success message. Press login and enjoy using the platform!</li>
</ol>
<img alt="_images/img-register-finish.png" class="align-center" src="_images/img-register-finish.png" />
</div>
<hr class="docutils" />
<div class="section" id="invite-an-organisation-or-user">
<h3>Invite an organisation or user<a class="headerlink" href="#invite-an-organisation-or-user" title="Permalink to this headline">¶</a></h3>
<p>Any platform user can invite new organisations or users. An organisation invitation would generate a new organisation, while inviting a user means that the new user will be registered under the organisation that is triggering the invitation.</p>
<p>In order to initiate an invitation you should click in an icon located at the top-right corner of the app.</p>
<img alt="_images/img-invite.png" class="align-center" src="_images/img-invite.png" />
<div class="section" id="invite-a-new-organisation">
<h4>Invite a new organisation<a class="headerlink" href="#invite-a-new-organisation" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>After providing an organisation name and valid mail, a mail will be sent and the administrator of the new organisation will follow a process similar to the regular registration except the administrator of the platform will not need to validate the registration request.</li>
</ul>
<img alt="_images/img-invite-organisation.png" class="align-center" src="_images/img-invite-organisation.png" />
</div>
<div class="section" id="invite-a-new-user-under-your-organisation">
<h4>Invite a new user under your organisation<a class="headerlink" href="#invite-a-new-user-under-your-organisation" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>After providing a user name and valid mail, a mail will be sent and the new user will follow a process similar to the regular registration except the administrator of the platform will not need to validate the registration request. After registering the new user will appear under the organisation that invited it.</li>
</ul>
<img alt="_images/img-invite-user.png" class="align-center" src="_images/img-invite-user.png" />
</div>
</div>
<hr class="docutils" />
<div class="section" id="quick-registration-for-api-developers">
<h3>Quick registration for API developers<a class="headerlink" href="#quick-registration-for-api-developers" title="Permalink to this headline">¶</a></h3>
<p>In order to use this option of registering organisations, the interested user needs to request “superUser” role to the platform admin. Once granted, this API endpoint offers an way to program the registration of new organisations, speeding up the process.</p>
<p><a class="reference external" href="https://vicinityh2020.github.io/vicinity-neighbourhood-manager-api/#/organisations/postAutoOrganisation">Fast registration endpoint documentation</a></p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="organisation-and-user-management">
<h2>Organisation and user management<a class="headerlink" href="#organisation-and-user-management" title="Permalink to this headline">¶</a></h2>
<p>This section is focus on the organisations and user. First their properties will be shown and explained, to then show what is possible to update and manage using the UI.</p>
<hr class="docutils" />
<div class="section" id="organisation-properties">
<h3>Organisation properties<a class="headerlink" href="#organisation-properties" title="Permalink to this headline">¶</a></h3>
<p>The organisation is the main entity in the platform. Under the organisation there can be registered several users and gateways. Everything in the in the platform has to belong to an organisation.</p>
<p>To characterise an organisation there is a series of properties and relationships.</p>
<div class="section" id="properties">
<h4>Properties<a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="67%" />
<col width="11%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Property</td>
<td>Description</td>
<td>Update</td>
</tr>
<tr class="row-even"><td>Name</td>
<td>Organisation name</td>
<td>NO</td>
</tr>
<tr class="row-odd"><td>CID</td>
<td>External ID</td>
<td>NO</td>
</tr>
<tr class="row-even"><td>BID*</td>
<td>Business ID</td>
<td>NO</td>
</tr>
<tr class="row-odd"><td>Avatar</td>
<td>Organisation logo</td>
<td>YES</td>
</tr>
<tr class="row-even"><td>Location</td>
<td>Country or city</td>
<td>YES</td>
</tr>
<tr class="row-odd"><td>Notes</td>
<td>Information about the organisation</td>
<td>YES</td>
</tr>
<tr class="row-even"><td>Skin color</td>
<td>Account app colour</td>
<td>YES</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If your organisation/association lacks BID or your are a legal person you might choose a random number or string.</p>
</div>
<p>Some of the properties can be modified/updated. To do so navigate to the organisation profile and update them using the edit buttons. The avatar can be updated by clicking over it. Note that <strong>_in order to update the organisation profile you need to have the administrator role._</strong></p>
<img alt="_images/img-org-profile.png" class="align-center" src="_images/img-org-profile.png" />
</div>
<div class="section" id="relationships">
<h4>Relationships<a class="headerlink" href="#relationships" title="Permalink to this headline">¶</a></h4>
<p>The organisation is linked to other entities as previously mentioned.</p>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="85%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Relation</td>
<td>Description</td>
</tr>
<tr class="row-even"><td>Gateways</td>
<td>All the infrastructures registered under the organisation</td>
</tr>
<tr class="row-odd"><td>Users</td>
<td>All the users registered under the organisation</td>
</tr>
<tr class="row-even"><td>Partners</td>
<td>Other organisations that agreed to be partners</td>
</tr>
<tr class="row-odd"><td>Notifications</td>
<td>Some actions trigger notifications that are sent to the whole organisation</td>
</tr>
<tr class="row-even"><td>Audits</td>
<td>Keeps track of relevant events for the organisation (History)</td>
</tr>
</tbody>
</table>
<p>To visually see all these relationships in the UI is very easy, see below how:</p>
<ul class="simple">
<li>Partners, audits and users: Directly in the organisation profile.</li>
</ul>
<img alt="_images/img-org-profile-relations.png" class="align-center" src="_images/img-org-profile-relations.png" />
<ul class="simple">
<li>Gateways: In the side menu there is a tab dedicated to them. You need to be system integrator to see this menu.</li>
</ul>
<img alt="_images/img-gateways.png" class="align-center" src="_images/img-gateways.png" />
<ul class="simple">
<li>Notifications: The bell on the top menu shows all notifications addressed to the organisation.</li>
</ul>
<img alt="_images/img-notifications.png" class="align-center" src="_images/img-notifications.png" />
</div>
</div>
<hr class="docutils" />
<div class="section" id="user-properties-and-roles">
<h3>User properties and roles<a class="headerlink" href="#user-properties-and-roles" title="Permalink to this headline">¶</a></h3>
<p>This section covers all user properties and relations to other entities.
It will deal separately with the <strong>roles</strong>, since it is the most
complex part of a user. An organisation can have many users, and each of
them can play one or several roles. Managing infrastructures, services
or the organisation account are some of the tasks.</p>
<div class="section" id="id5">
<h4>Properties<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="73%" />
<col width="9%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Property</td>
<td>Description</td>
<td>Update</td>
</tr>
<tr class="row-even"><td>Name</td>
<td>User name</td>
<td>NO</td>
</tr>
<tr class="row-odd"><td>Email</td>
<td>Registration mail and external ID</td>
<td>NO</td>
</tr>
<tr class="row-even"><td>Contact Mail</td>
<td>E-mail address to contact user after registration</td>
<td>YES</td>
</tr>
<tr class="row-odd"><td>Avatar</td>
<td>User logo</td>
<td>YES</td>
</tr>
<tr class="row-even"><td>Password</td>
<td>Credentials to log in the platform</td>
<td>YES</td>
</tr>
<tr class="row-odd"><td>Occupation</td>
<td>Information about the organisation</td>
<td>YES</td>
</tr>
<tr class="row-even"><td>Visibility*</td>
<td>Who can see the user in the platform</td>
<td>YES</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The visibility of the user has to be always higher than the visibility of its devices and services. Therefore if there is an attempt to give a device public visibility while the user is private or only visible to friends, there will be a warning notification stating the issue.</p>
</div>
<p>Some of the properties can be modified/updated. To do so navigate to the
user profile and update them using the edit buttons. The avatar can be
updated by clicking over it.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Note that only a user can update its own properties. An exception to this rule are the roles, which will be explained in the next section.</p>
</div>
<img alt="https://github.com/vicinityh2020/vicinity-neighbourhood-manager/wiki/Images/img-user-properties.png" class="align-center" src="https://github.com/vicinityh2020/vicinity-neighbourhood-manager/wiki/Images/img-user-properties.png" />
</div>
<div class="section" id="id6">
<h4>Relationships<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h4>
<p>The user is linked to other entities as previously mentioned.</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Relation</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Items</td>
<td>All the devices and services managed by the user</td>
</tr>
<tr class="row-odd"><td>Contracts</td>
<td>Agreements to share data where the user participates</td>
</tr>
<tr class="row-even"><td>Notifications</td>
<td>Some actions trigger notifications that are sent to a single user</td>
</tr>
<tr class="row-odd"><td>Audits</td>
<td>Keeps track of relevant events for the user (History)</td>
</tr>
</tbody>
</table>
<p>To visually see all these relationships in the UI is very easy, see
below how:</p>
<ul class="simple">
<li>Items, audits and contracts: Directly in the user profile.</li>
</ul>
<img alt="https://github.com/vicinityh2020/vicinity-neighbourhood-manager/wiki/Images/img-user-profile-relations.png" class="align-center" src="https://github.com/vicinityh2020/vicinity-neighbourhood-manager/wiki/Images/img-user-profile-relations.png" />
<ul class="simple">
<li>Notifications: The bell on the top menu shows all notifications addressed to the user.</li>
</ul>
<img alt="https://github.com/vicinityh2020/vicinity-neighbourhood-manager/wiki/Images/img-notifications.png" class="align-center" src="https://github.com/vicinityh2020/vicinity-neighbourhood-manager/wiki/Images/img-notifications.png" />
</div>
<div class="section" id="roles">
<h4>Roles<a class="headerlink" href="#roles" title="Permalink to this headline">¶</a></h4>
<p>There are 6 user roles in the platform:</p>
<ul class="simple">
<li>User: All users have this role by default</li>
<li><dl class="first docutils">
<dt>Administrator: The user that registers an organisation gets this role by default. It can be also granted to other users afterwards. It is necessary to be administrator in order to:</dt>
<dd><ul class="first last">
<li>Modify organisation properties</li>
<li>Remove and organisation</li>
<li>Update users roles</li>
</ul>
</dd>
</dl>
</li>
<li>Device owner: A user with this role can enable devices. When enabling a device, the user becomes its responsible platform-wise and it can manage its properties and share its data.</li>
<li>Service provider: A user with this role can enable services. When enabling a service, the user becomes its responsible platform-wise and it can manage its properties and share its data.</li>
<li>System integrator: A user that can manage the gateways (agents/adapters) of the platform. Can create, update and remove gateways.</li>
<li>Infrastructure operator: A user that can initiate contracts. In other words the responsible to choose which service can adequate to some of the devices of its organisation and request it.</li>
</ul>
<p>The infrastructure operator can be the owner of devices or not (having the role of device owner). In case the devices chosen to be part of a contract do not belong to the infrastructure operator, the actual owners will be asked for permission. The contract will be completed only with those devices whose owners agreed. Additionally there is a role granted by the platform administrator: * superUser: This role is reserved for developers interested in using the API. With this role, it is possible to use a faster registration method.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="organisation-management">
<h3>Organisation management<a class="headerlink" href="#organisation-management" title="Permalink to this headline">¶</a></h3>
<p>Besides updating properties there are some other aspects of an
organisation that can be managed:</p>
<div class="section" id="organisations-view">
<h4>Organisations view<a class="headerlink" href="#organisations-view" title="Permalink to this headline">¶</a></h4>
<p>It is one of the tabs in the sidebar menu. It allows to see which
organisations exist in the platform and to filter them by friends and
not friends.</p>
<img alt="_images/img-org-sidebar-filter.png" class="align-center" src="_images/img-org-sidebar-filter.png" />
</div>
<div class="section" id="friendships">
<h4>Friendships<a class="headerlink" href="#friendships" title="Permalink to this headline">¶</a></h4>
<p>Any user can request to establish a friendship between its organisation
and any other. There are 5 possible actions during the partnership
process. All of them can be performed from the profile of the potential
friend.</p>
<ul class="simple">
<li>Request partnership</li>
</ul>
<p>You are initiating the partnership process</p>
<img alt="_images/img-org-friendship-request.png" class="align-center" src="_images/img-org-friendship-request.png" />
<ul class="simple">
<li>Manage partnership</li>
</ul>
<p>You receive a partnership request. You can see if you have requests in
the notifications area.</p>
<img alt="_images/img-org-friendship-manage.png" class="align-center" src="_images/img-org-friendship-manage.png" />
<p>Also possible to manage the request from the notifications.</p>
<img alt="_images/img-org-friendship-notification.png" class="align-center" src="_images/img-org-friendship-notification.png" />
<ul class="simple">
<li>Cancel partnership</li>
</ul>
<p>You decide to stop a partnership. The other party will receive a
notification.</p>
<img alt="_images/img-org-friendship-cancel.png" class="align-center" src="_images/img-org-friendship-cancel.png" />
<ul class="simple">
<li>Cancel partnership request</li>
</ul>
<p>You decide to stop a partnership request.</p>
<img alt="_images/img-org-friendship-cancel-request.png" class="align-center" src="_images/img-org-friendship-cancel-request.png" />
</div>
<div class="section" id="remove-organisation">
<h4>Remove organisation<a class="headerlink" href="#remove-organisation" title="Permalink to this headline">¶</a></h4>
<p>Users with the administrator role can proceed to remove an organisation
from the organisation profile.</p>
<a class="reference internal image-reference" href="_images/img-org-profile-remove.png"><img alt="_images/img-org-profile-remove.png" class="align-center" src="_images/img-org-profile-remove.png" style="width: 400px; height: 800px;" /></a>
</div>
</div>
<hr class="docutils" />
<div class="section" id="user-management">
<h3>User management<a class="headerlink" href="#user-management" title="Permalink to this headline">¶</a></h3>
<p>An administrator has certain control over its organisation users. As of
now, an administrator can remove or change the roles of a user.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Important notes regarding change of roles and user removal: The rules below apply both the case that we want to remove a user or just change a role.</p>
</div>
<ul>
<li><p class="first">There must be in all moments at least one organisation administrator.</p>
</li>
<li><p class="first">There are some roles that cannot be removed if the user is still bound to some of its responsibilities, i.e:</p>
<blockquote>
<div><ul class="simple">
<li>A device owner cannot be removed until the user does not have any devices under its responsibility. The devices can be either deleted, disabled or moved to another user.</li>
<li>A service provider cannot be removed until the user does not have any services under its responsibility. The services can be either deleted, disabled or moved to another user.</li>
<li>A infrastructure operator cannot be removed until all contracts it is responsible for are either moved to other infrastructure operator or cancelled.</li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="section" id="remove-user">
<h4>Remove user<a class="headerlink" href="#remove-user" title="Permalink to this headline">¶</a></h4>
<p>It is possible to remove users from the organisation profile, under the tab role management.</p>
<img alt="_images/img-org-roles-remove.png" class="align-center" src="_images/img-org-roles-remove.png" />
</div>
<div class="section" id="change-roles">
<h4>Change roles<a class="headerlink" href="#change-roles" title="Permalink to this headline">¶</a></h4>
<p>As mentioned, only administrators can add/remove roles. Otherwise the process is simple and it is located under the organisation profile.</p>
<img alt="_images/img-org-role-mgmt.png" class="align-center" src="_images/img-org-role-mgmt.png" />
<img alt="_images/img-org-role-mgmt-update.png" class="align-center" src="_images/img-org-role-mgmt-update.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In order for the changes to take effect, the user that had its roles changed might need to log in again.</p>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="infrastructure-management">
<h2>Infrastructure Management<a class="headerlink" href="#infrastructure-management" title="Permalink to this headline">¶</a></h2>
<p>This section is focused on the infrastructure level. The properties and main features of the infrastructure entities will be explained in the following subsections.</p>
<hr class="docutils" />
<div class="section" id="access-points">
<h3>Access Points<a class="headerlink" href="#access-points" title="Permalink to this headline">¶</a></h3>
<p>This section is about the Access Points, which are the virtual
representation of an infrastructure. In a real scenario, an access point
represents 2 or 3 components:</p>
<ul class="simple">
<li>Gateway: Software that is used to communicate with the platform’s communication server and the P2P network. See all information regarding the VICINITY Open Gateway <a class="reference external" href="https://github.com/vicinityh2020/vicinity-neighbourhood-manager/blob/master/TBD">HERE</a></li>
<li>Agent: [OPTIONAL] It is used to register the smart components of an infrastructure into the platform. It implements logic to handle the process of registering, updating and removing items from/to the platform. It needs to have the infrastructure components described in a common format. See all information regarding the VICINITY agent <a class="reference external" href="https://github.com/vicinityh2020/vicinity-agent">HERE</a></li>
<li>Adapter: It is the specific software that translates the infrastructure conventions, definitions or API endpoints into the common format. It is mapping all the properties and capabilities of each smart component so the platform can understand what it is. It could implement some of the agent functionalities depending on the needs.</li>
</ul>
<p>To be able to manage the access points in the platform, a user needs to have the system integrator role. Having this role opens the access point view in the sidebar,</p>
<a class="reference internal image-reference" href="_images/img-gateways.png"><img alt="_images/img-gateways.png" class="align-center" src="_images/img-gateways.png" style="width: 300px; height: 600px;" /></a>
<p>and from this view it is possible to manage all the access points. The image below is going to be referenced in the following sub-sections to describe all its details.</p>
<div class="figure align-center" id="id19">
<img alt="_images/img-gat-view.png" src="_images/img-gat-view.png" />
<p class="caption"><span class="caption-text">Example figure</span></p>
</div>
<div class="section" id="id8">
<h4>Properties<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h4>
<p>As we can see in the example figure there are 3 main properties.</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="79%" />
<col width="9%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Description</th>
<th class="head">Update</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Name</td>
<td>Friendly name</td>
<td>YES</td>
</tr>
<tr class="row-odd"><td>AGID*</td>
<td>External ID</td>
<td>NO</td>
</tr>
<tr class="row-even"><td>Type</td>
<td>Indicates to which project belongs the infrastructure</td>
<td>YES</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is an important field because when initialising the agent/adapter, this ID will be used in the authentication credentials together with the password. The password will be introduced by the system integrator when creating the gateway entity and will not be stored by the web application.</p>
</div>
</div>
<div class="section" id="id9">
<h4>Relationships<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h4>
<p>The access point belongs to an organisation and at the same time can have several items (devices and services).</p>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="82%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Relation</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Items</td>
<td>All the smart components and services</td>
</tr>
</tbody>
</table>
<p>In the example picture it is possible to see the count of items for each infrastructure, in addition, each item has in the profile the name and AGID of its agent/adapter. For system integrators using the Open Gateway API there are calls that return all items registered under the agent/adapter among other interesting options.</p>
</div>
<div class="section" id="manage">
<h4>Manage<a class="headerlink" href="#manage" title="Permalink to this headline">¶</a></h4>
<p>Here we will focus on the highlighted area of the example picture. Those are the actions that can be done over the infrastructure.</p>
<ol class="arabic simple">
<li><dl class="first docutils">
<dt>In the first place there is creating a new access point. The process is simple just follow these steps:</dt>
<dd><ul class="first last">
<li>Add a name</li>
<li>Select a type</li>
<li>Give a password</li>
<li>Submit the form</li>
</ul>
</dd>
</dl>
</li>
</ol>
<blockquote>
<div><img alt="_images/img-gat-create.png" class="align-center" src="_images/img-gat-create.png" />
</div></blockquote>
<ol class="arabic simple" start="2">
<li>In the second place, there is a view/modify option. When clicking a new view opens with the access point detail:</li>
</ol>
<blockquote>
<div><img alt="_images/img-gat-profile.png" class="align-center" src="_images/img-gat-profile.png" />
</div></blockquote>
<p>If we click over modify the view changes and it is possible to update the name and password of the access point.</p>
<blockquote>
<div><img alt="_images/img-gat-modify.png" class="align-center" src="_images/img-gat-modify.png" />
</div></blockquote>
<ol class="arabic simple" start="3">
<li>At last, it is possible to remove a access point from the platform. This means that the platform will forget your infrastructure.</li>
</ol>
</div>
</div>
<hr class="docutils" />
<div class="section" id="items">
<h3>Items<a class="headerlink" href="#items" title="Permalink to this headline">¶</a></h3>
<p>This section describes the item entity. In a real infrastructure, an item can be a smart device or a value-added service.</p>
<p>All the items need an adapter/agent and a gateway to be integrated in the platform. Once registered, users with service provider or device owner roles will be responsible for the services and devices respectively.</p>
<div class="section" id="id10">
<h4>Properties<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h4>
<p>In the table is possible to see the most relevant properties, for those which are possible to update there will be a separate sub-section in the last section of this page (“Manage”).</p>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="70%" />
<col width="11%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Description</th>
<th class="head">Update</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Name</td>
<td>Friendly name</td>
<td>NO</td>
</tr>
<tr class="row-odd"><td>OID</td>
<td>External ID</td>
<td>NO</td>
</tr>
<tr class="row-even"><td>Type</td>
<td>Indicates if it is a service or device</td>
<td>NO</td>
</tr>
<tr class="row-odd"><td>Visibility</td>
<td>Private, for friends, public</td>
<td>YES</td>
</tr>
<tr class="row-even"><td>Info*</td>
<td>Thing description of the item</td>
<td>YES</td>
</tr>
<tr class="row-odd"><td>Avatar**</td>
<td>Item logo</td>
<td>YES</td>
</tr>
<tr class="row-even"><td>Status</td>
<td>Enabled/Disabled</td>
<td>YES</td>
</tr>
</tbody>
</table>
<p>* It can only be updated with the adapter/agent
** Can be updated clicking over it and selecting a new picture from the folder</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Info property: Thing description of the item In the item profile, there is a tab call “Description” that shows a series of collapsible tiles containing all the properties that define the Thing Description of the item. We can find there all the available properties and actions for the given item. This properties, actions and events are the same that can be requested using the consumption endpoints of the <a class="reference external" href="https://github.com/vicinityh2020/vicinity-neighbourhood-manager/wiki/TBD">Open Gateway API</a></p>
</div>
<a class="reference internal image-reference" href="_images/img-items-description.png"><img alt="_images/img-items-description.png" class="align-center" src="_images/img-items-description.png" style="width: 600px; height: 600px;" /></a>
</div>
<div class="section" id="id11">
<h4>Relationships<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h4>
<p>The items belong to a gateway and to a user. It can have contracts and audits.</p>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="82%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Relation</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Contracts</td>
<td>Agreement to share device data</td>
</tr>
<tr class="row-odd"><td>Audits</td>
<td>Most relevant events of the item (History)</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id12">
<h4>Manage<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h4>
<p>See the platform items In the sidebar menu, there are two tabs for the items: Devices (Orange widget) and services (Yellow widget). These views show your items, public items and items of your friends that are flagged as “visible for friends”. There are as well filtering options.</p>
<a class="reference internal image-reference" href="_images/img-items-sidebar-view.png"><img alt="_images/img-items-sidebar-view.png" class="align-center" src="_images/img-items-sidebar-view.png" style="width: 1000px; height: 400px;" /></a>
<p>Each widget contains certain information about the item. We can see in the device widget a yellow-highlighted area with the item name and the organisation that owns the item. Right below there is a green-highligted are showing the status and visibility of the item. There is also an avatar on the top left corner and the logo type of adapter that has integrated the item on the right bottom corner. Finally, at the bottom there is a line with the owner of the item and a link to the profile.</p>
<div class="figure align-center" id="id20">
<img alt="_images/img-items-device-widget.png" src="_images/img-items-device-widget.png" />
<p class="caption"><span class="caption-text">Device widget</span></p>
</div>
<p>In the service widget there is also a green action button in the case that the service is possible to request. Pressing <em>+Request Service</em> would initiate the contract process.</p>
<div class="figure align-center" id="id21">
<img alt="_images/img-items-service-widget.png" src="_images/img-items-service-widget.png" />
<p class="caption"><span class="caption-text">Service widget</span></p>
</div>
</div>
<div class="section" id="status-visibility">
<h4>Status &amp; visibility<a class="headerlink" href="#status-visibility" title="Permalink to this headline">¶</a></h4>
<p>An item can go through several status and visibility levels, see the table below to understand some of the possible actions and effects in the item lifecycle.</p>
<table border="1" class="docutils">
<colgroup>
<col width="44%" />
<col width="24%" />
<col width="10%" />
<col width="13%" />
<col width="10%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Visibility</th>
<th class="head">Status</th>
<th class="head">hasGateway</th>
<th class="head">hasOwner</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Agent registers item in platform</td>
<td>Private</td>
<td>Disabled</td>
<td>YES</td>
<td>NO</td>
</tr>
<tr class="row-odd"><td>User enables item</td>
<td>Private</td>
<td>Enabled</td>
<td>YES</td>
<td>YES</td>
</tr>
<tr class="row-even"><td>User makes item visible for friends</td>
<td>Visible for friends</td>
<td>Enabled</td>
<td>YES</td>
<td>YES</td>
</tr>
<tr class="row-odd"><td>User makes item public</td>
<td>Public</td>
<td>Enabled</td>
<td>YES</td>
<td>YES</td>
</tr>
<tr class="row-even"><td>User disables item</td>
<td>Private</td>
<td>Disabled</td>
<td>YES</td>
<td>NO</td>
</tr>
<tr class="row-odd"><td>User deletes item</td>
<td>N/A</td>
<td>Deleted</td>
<td>NO</td>
<td>NO</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">IMPORTANT: In order to assign a visibility level the device must be enabled. As well, it is important to remember that the visibility level of a device must remain lower than the visibility of its user owner.</p>
</div>
<p>Now we will see the all possible status and visibility levels and how to change them from the item profile.</p>
<ol class="arabic simple">
<li><dl class="first docutils">
<dt>Status There are three possible status for an item:</dt>
<dd><ul class="first last">
<li>Disabled: When an item has just been registered, it appears as disabled in the platform. An item can be disabled by its owner anytime. Being disabled means that the item is private and is not visible in the P2P network. Furthermore a disabled item does not have owner assigned in the platform.</li>
<li><dl class="first docutils">
<dt>Enabled: When a user claims an item, this turns to the enabled status. Now it is possible to change the visibility level and use it in contracts. It is possible to see the following changes in the “Disabled vs Enabled” picture.</dt>
<dd><ul class="first last">
<li>New section with visibility settings</li>
<li>User owner of the item added</li>
<li>Button to change user enabled</li>
<li>New section with a button to remove the device</li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
</ol>
<div class="figure align-center" id="id22">
<a class="reference internal image-reference" href="_images/img-items-compare.png"><img alt="_images/img-items-compare.png" src="_images/img-items-compare.png" style="width: 700px; height: 700px;" /></a>
<p class="caption"><span class="caption-text">Disabled vs Enabled</span></p>
<div class="legend">
<blockquote>
<div><ul class="simple">
<li>Deleted: The owner of the item can decide to remove it from the platform. This will remove the item from all existing contracts and it will make it no longer visible in the platform. This action can also be triggered using the agent.</li>
</ul>
</div></blockquote>
</div>
</div>
<a class="reference internal image-reference" href="_images/img-items-remove.png"><img alt="_images/img-items-remove.png" class="align-center" src="_images/img-items-remove.png" style="width: 300px; height: 600px;" /></a>
<ol class="arabic simple" start="2">
<li>Visibility</li>
</ol>
<p>There are also three visibility levels:
* Private: Only my organisation can see the item.
* Visible for friends: Other organisations that are partners with mine can see the item and request its data making use of a contract.
* Public: All organisations can see the item and request its data making use of a contract.</p>
<p>To change the visibility go to the item profile and use the option highlighted. Remember to enable the device and set the visibility of your user adequately. See the process below:</p>
<a class="reference internal image-reference" href="_images/img-items-visibility.png"><img alt="_images/img-items-visibility.png" class="align-center" src="_images/img-items-visibility.png" style="width: 600px; height: 600px;" /></a>
</div>
<div class="section" id="move-an-item">
<h4>Move an item<a class="headerlink" href="#move-an-item" title="Permalink to this headline">¶</a></h4>
<p>It is possible to change the owner or gateway of an item without interfering existing contracts or doing any additional changes. For that it is necessary to be the current owner of the device or an organisation administrator. Nevertheless, there are some conditions that have to be met:</p>
<ul class="simple">
<li>Case of changing a gateway: New gateway needs to have the same type. I.e: Vicinity agent to Vicinity agent.</li>
<li>Case of changing owner: New user need to have device owner or service provider role (Depending on the item you are moving). The privacy level of the item you are moving will be reduced if the new user has lower visibility, be aware that this can cause that your device will be removed from some contracts. <a href="#id13"><span class="problematic" id="id14">*</span></a>Check the visibility of the new user</li>
</ul>
<p>to avoid issues.*</p>
<p>Moving an item can be specially useful in the situation of a leaving employee or change of responsibilities within an organisation. The status of the items under the responsibility of this person will remain unchanged, but we can have a different person in charge.</p>
<p>To move an item go to the item profile and select one of the options in the move item menu. When you click over change owner or change gateway, you will see a dropdown menu where you can select the desired option and finish the process by clicking save.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Note that if the device is disabled you will only be able to change the gateway because there is no item owner at the moment.</p>
</div>
<a class="reference internal image-reference" href="_images/img-items-move.png"><img alt="_images/img-items-move.png" class="align-center" src="_images/img-items-move.png" style="width: 600px; height: 600px;" /></a>
</div>
</div>
<hr class="docutils" />
<div class="section" id="contracts">
<h3>Contracts<a class="headerlink" href="#contracts" title="Permalink to this headline">¶</a></h3>
<p>This section covers one of the last additions to the platform, the contracts. Through contracts is how devices and services of different organisations can share data and interact.</p>
<p>Currently there is only one contract type “Service Request”. In this type of contract, services and devices from organisation_one can request to use a service from organisation_two. This service will be monitoring (or monitoring and controlling) those items that were added to the contract by organisation_one.</p>
<p>In order to create a contract we need to follow these steps:</p>
<ul class="simple">
<li>A user with role <em>Infrastructure Operator</em> selects a service (public or from a partner organisation)</li>
<li><dl class="first docutils">
<dt>Then the <em>Infrastructure Operator</em> needs to choose the contract settings:</dt>
<dd><ul class="first last">
<li>Select items (with fitting visibility) from his organisation. Can be from different users.</li>
<li>Choose if we want to give write rights to the service or not.</li>
<li>Approve the terms and conditions.</li>
</ul>
</dd>
</dl>
</li>
<li>A notification will be sent to the service owner.</li>
<li>Once the service provider approves the contract, the service can start sharing data with the items belonging to the <em>Infrastructure Operator</em>, if he had any. All other items that belong to different users will not be part of the contract until their owners give consent.</li>
<li>Therefore, the next step is to send a notification to all users so they can approve or reject the contract.</li>
<li>In the end the contract is completed with the <em>Infrastructure Operator</em>, <em>Service Provider</em> and all other users that gave consent to share data.</li>
<li>Any time a user can withdraw from the contract. In the subsequent points we will define the properties, relations and actions that the contract has got in order to fulfil its purpose.</li>
</ul>
<a class="reference internal image-reference" href="_images/img-contracts-main.png"><img alt="_images/img-contracts-main.png" class="align-center" src="_images/img-contracts-main.png" style="width: 300px; height: 600px;" /></a>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<dl class="last docutils">
<dt>Important notes:</dt>
<dd><ul class="first last simple">
<li>To request a service you need to be IoT operator.</li>
<li>If the contract includes devices that belong to your organisation, but you are not the owner, then the respective owners will need to agree the contract. Meanwhile, these devices will appear as inactive or disabled, and will not be reachable by the service.</li>
<li>All users with devices/services in the contract, will see the contract in their respective contracts view.</li>
<li>The IoT operator and the service provider are considered administrators of the contract. They can cancel the contract anytime unilaterally. If a user that is not admin, presses the button to remove the contract, only itself and its devices will be removed. The contract will remain with the rest of the users.</li>
<li>The items involved in the contract can be managed individually, but only by their owners.</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="id15">
<h4>Properties<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h4>
<p>In the table is possible to see the most relevant properties, for those which are possible to update there will be a separate sub-section in the last section of this page (“Manage”).</p>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="74%" />
<col width="8%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Description</th>
<th class="head">Update</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>CTID</td>
<td>External ID</td>
<td>NO</td>
</tr>
<tr class="row-odd"><td>IoT Owner*</td>
<td>Object with relevant info of the infrastructure owner</td>
<td>YES</td>
</tr>
<tr class="row-even"><td>Foreign IoT*</td>
<td>Object with relevant info of the service owner</td>
<td>YES</td>
</tr>
<tr class="row-odd"><td>Status</td>
<td>Active or deleted</td>
<td>YES</td>
</tr>
<tr class="row-even"><td>R/W</td>
<td>Monitor or monitor &amp; control</td>
<td>NO</td>
</tr>
<tr class="row-odd"><td>T&amp;C</td>
<td>Terms and conditions</td>
<td>YES</td>
</tr>
<tr class="row-even"><td>Type</td>
<td>Right now, only service request</td>
<td>NO</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt><em>(*)</em> IoT Owner and foreign IoT contain:</dt>
<dd><ul class="first last simple">
<li>Users with items involved in the contract;</li>
<li>Information about the organisations the users belong to;</li>
<li>Items in the contract with a flag stating whether they are active or not;</li>
<li>Flag indicating if the terms and conditions were accepted. Only the IoT Provider and the Service Provider need to approve the T&amp;C on behalf of the rest of users. However, each user can decide if its devices are included in the contract.</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="id16">
<h4>Relationships<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h4>
<p>Each item and user involved in a contract has information of it stored in an array of contracts.</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="76%" />
<col width="6%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Description</th>
<th class="head">Update</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>CTID</td>
<td>External ID</td>
<td>NO</td>
</tr>
<tr class="row-odd"><td>ID</td>
<td>Mongo ID</td>
<td>NO</td>
</tr>
<tr class="row-even"><td>imForeign</td>
<td>If true, user is service provider</td>
<td>NO</td>
</tr>
<tr class="row-odd"><td>imAdmin</td>
<td>If true, user is IoT Operator (or Service Provider if ImForeign = TRUE)</td>
<td>NO</td>
</tr>
<tr class="row-even"><td>approved</td>
<td>Indicates whether the user has agreed T&amp;C</td>
<td>YES</td>
</tr>
<tr class="row-odd"><td>inactive</td>
<td>Array with user inactive devices</td>
<td>YES</td>
</tr>
<tr class="row-even"><td>readWrite</td>
<td>Contract with monitor or control capabilities</td>
<td>NO</td>
</tr>
<tr class="row-odd"><td>contractingUser</td>
<td>ID of the administrator of the other side of the contract</td>
<td>NO</td>
</tr>
<tr class="row-even"><td>contractingParty</td>
<td>ID of the organisation of the other side of the contract</td>
<td>NO</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="main-views">
<h4>Main views<a class="headerlink" href="#main-views" title="Permalink to this headline">¶</a></h4>
<p><em>Request contract</em></p>
<p>To access this view a user with IoT Operator role needs to click on the “request service” button of any eligible service.</p>
<ol class="arabic simple">
<li>Read the description of the service you are requesting.</li>
<li>Select the devices/services you would like to include in the contract.</li>
<li>Grant control or control&amp;monitoring permissions to the service over your infrastructure.</li>
<li>Read and accept the terms and conditions.</li>
</ol>
<a class="reference internal image-reference" href="_images/img-contracts-request.png"><img alt="_images/img-contracts-request.png" class="align-center" src="_images/img-contracts-request.png" style="width: 600px; height: 600px;" /></a>
<p><em>All contracts view</em></p>
<p>To access this view users with “device owner”, “service provider” or “IoT Operator” roles, just need to click on the sidebar the contracts link.
1. See if your organisation is providing (red flag) or using the service (green flag).
2. See some important information: Service name, service provider name, owner of the infrastructure, number of items in the infrastructure, status of the contract, and type and permissions.
3. Actions: Approve, see details and cancel contract.</p>
<a class="reference internal image-reference" href="_images/img-contracts-view.png"><img alt="_images/img-contracts-view.png" class="align-center" src="_images/img-contracts-view.png" style="width: 1000px; height: 200px;" /></a>
<p><em>Contract detail</em></p>
<p>To access this view users with “device owner”, “service provider” or “IoT Operator” roles, just need to click on the eye icon that you will find in each contract instance of the “all contracts view”.
1. Information of the service provider and service used.
2. Legal description of the contract.
3. Items info:</p>
<blockquote>
<div><ul class="simple">
<li>Name, OID, type of item, owner, status and actions.</li>
<li>Actions are affecting status of the items in the contract. It is possible to enable, disable and remove item from the contract.</li>
</ul>
</div></blockquote>
<p>4. Contract action buttons:
* Transfer contract, accept contract, remove contract and close details.</p>
<a class="reference internal image-reference" href="_images/img-contracts-detail.png"><img alt="_images/img-contracts-detail.png" class="align-center" src="_images/img-contracts-detail.png" style="width: 1000px; height: 500px;" /></a>
</div>
<div class="section" id="id17">
<h4>Manage<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h4>
<p><em>Create a contract</em></p>
<ol class="arabic simple">
<li>Select a service and click “Request service”. Do it from the services view or from a service profile.</li>
<li>The “request service view” opens, there you can see all the information about the service you are requesting and select the items that you would like to share with it. Also it is possible to grant read or read/write permissions to the service over your devices.</li>
<li>Once you agree the terms and conditions, it is possible to submit the contract request.</li>
<li>Now the contract appears in the “all contracts view” (sidebar menu). The contract will be active once the service provider accepts the request.</li>
<li>All parties should receive notifications with the status of the contract.</li>
</ol>
<a class="reference internal image-reference" href="_images/img-contracts-request-service.png"><img alt="_images/img-contracts-request-service.png" class="align-center" src="_images/img-contracts-request-service.png" style="width: 1000px; height: 500px;" /></a>
<p><em>Accept, see or remove a contract</em></p>
<p>Within the “all contracts view” you have several actions for each contract.</p>
<ul class="simple">
<li>See details: Represented by an eye. Opens the “contract detail view”.</li>
<li>Accept a contract: Green check sign.</li>
<li>If you are an administrator: Accepts contract.</li>
<li>If you are a normal user: Enables your devices in the contract.</li>
<li>Remove contract: Red cross.</li>
<li>If you are an administrator: Removes contract.</li>
<li>If you are a normal user: Removes you and your items from the contract.</li>
</ul>
<a class="reference internal image-reference" href="_images/img-contracts-actions.png"><img alt="_images/img-contracts-actions.png" class="align-center" src="_images/img-contracts-actions.png" style="width: 400px; height: 200px;" /></a>
<p><em>Transfer a contract</em>
It is possible to transfer the responsibility of being the administrator of a contract. To do so click in the exchange button in the “contract detail view” and select a suitable recipient for the responsibility. That would be some user with the IoT Operator role.</p>
<a class="reference internal image-reference" href="_images/img-contracts-actions-move.png"><img alt="_images/img-contracts-actions-move.png" class="align-center" src="_images/img-contracts-actions-move.png" style="width: 400px; height: 100px;" /></a>
<p><em>Enable, disable and remove devices within a contract</em>
Each item can be managed individually by its owner. To do so, navigate to the “contract detail view” and at the bottom you will see all the items. Only those which are your will have actions available.</p>
<p>Enabling (green check) and disabling (pause sign) keep the item in the contract. A disabled/inactive device cannot be reached by the service.</p>
<p>Removing (red cross) a device, deletes all links of the device with the contract. After removing the device it is not possible to enable it back.</p>
<a class="reference internal image-reference" href="_images/img-contracts-device-actions.png"><img alt="_images/img-contracts-device-actions.png" class="align-center" src="_images/img-contracts-device-actions.png" style="width: 400px; height: 200px;" /></a>
</div>
<div class="section" id="update-items-in-the-contract">
<h4>Update items in the contract<a class="headerlink" href="#update-items-in-the-contract" title="Permalink to this headline">¶</a></h4>
<p>A system integrator may update devices or services in the infrastructure, and these items might be involved in some contracts. This could be an issue, since the updated item might have new properties or actions that were not included in the terms of conditions of previously existing contracts. To cope with this problem, the update process modifies the contracts in the following manner:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>When updating a device:</dt>
<dd><ol class="first last arabic">
<li>The device is put to disabled mode in all contracts.</li>
<li>Contracts flag the device as inactive.</li>
<li>The owner of the device is notified and then it is possible to revise the T&amp;C and accept or reject them.</li>
<li>If the device owner accepts the conditions the device will be added to the contract again, if not, will be permanently removed.</li>
</ol>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>When updating a service:</dt>
<dd><ol class="first last arabic">
<li>The contract is moved to the state when all parties need to approve the T&amp;C, it suffers a reset.</li>
<li>The items included in the contract cannot communicate anymore, until their owners approve the new T&amp;C. 3. All the users involved in the contract are notified, and once they approve the T&amp;C, the contract is re-established.</li>
</ol>
</dd>
</dl>
</li>
</ul>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="platform-evaluation">
<h2>Platform Evaluation<a class="headerlink" href="#platform-evaluation" title="Permalink to this headline">¶</a></h2>
<p>This section contains tools to evaluate the complexity of the platform.</p>
<hr class="docutils" />
<div class="section" id="tests">
<h3>Tests<a class="headerlink" href="#tests" title="Permalink to this headline">¶</a></h3>
<p>There have been set up some tests to check some of the functionalities of the platform. There is a special focus on the API. We will see in this section how to run the tests.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This functionality is available for the server only. (Navigate to the server root folder to execute the scripts that you will find below)</p>
</div>
<ol class="arabic simple">
<li>Set up a test db</li>
</ol>
<p>(In the section <a class="reference external" href="https://github.com/vicinityh2020/vicinity-neighbourhood-manager/wiki/Deployment-of-the-platform">Platform deployment</a>, there is more info regarding how to setup Mongo, create users or add authorisation to access databases)</p>
<blockquote>
<div><blockquote>
<div><ul class="simple">
<li>Create a clean mongo database. We will assume the name “nmapitest”.</li>
<li>Authorize one user to make use of this database. We will assume user and password to be “test”.</li>
<li>Insert a first user in “users” and organisation in “useraccounts” into the db “nmapitest”:</li>
</ul>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">db</span><span class="o">.</span><span class="n">useraccounts</span><span class="o">.</span><span class="n">insert</span><span class="p">({</span>
    <span class="s2">&quot;avatar&quot;</span> <span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;location&quot;</span> <span class="p">:</span> <span class="s2">&quot;SomeCountry&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cid&quot;</span> <span class="p">:</span> <span class="s2">&quot;admin-test&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;adminCorp&quot;</span><span class="p">,</span>
    <span class="s2">&quot;businessId&quot;</span> <span class="p">:</span> <span class="s2">&quot;1234-5678&quot;</span><span class="p">,</span>
    <span class="s2">&quot;hasNotifications&quot;</span> <span class="p">:</span> <span class="p">[],</span>
    <span class="s2">&quot;knowsRequestsTo&quot;</span> <span class="p">:</span> <span class="p">[],</span>
    <span class="s2">&quot;knowsRequestsFrom&quot;</span> <span class="p">:</span> <span class="p">[],</span>
    <span class="s2">&quot;knows&quot;</span> <span class="p">:</span> <span class="p">[],</span>
    <span class="s2">&quot;status&quot;</span> <span class="p">:</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span>
    <span class="s2">&quot;skinColor&quot;</span> <span class="p">:</span> <span class="s2">&quot;blue&quot;</span>
<span class="p">})</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">db</span><span class="o">.</span><span class="n">users</span><span class="o">.</span><span class="n">insert</span><span class="p">({</span>
  <span class="s2">&quot;email&quot;</span> <span class="p">:</span> <span class="s2">&quot;admin@admin.com&quot;</span><span class="p">,</span>
  <span class="s2">&quot;occupation&quot;</span> <span class="p">:</span> <span class="s2">&quot;Web Master&quot;</span><span class="p">,</span>
  <span class="s2">&quot;avatar&quot;</span> <span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;admin&quot;</span><span class="p">,</span>
  <span class="s2">&quot;authentication&quot;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;hash&quot;</span> <span class="p">:</span> <span class="s2">&quot;$2a$10$EFuFLZGxhfgScAnR/.aj9Osnbw/4sTmHcW2guFesyIChSr8w/bSHC&quot;</span><span class="p">,</span>
      <span class="s2">&quot;principalRoles&quot;</span> <span class="p">:</span> <span class="p">[</span>
          <span class="s2">&quot;user&quot;</span><span class="p">,</span>
          <span class="s2">&quot;administrator&quot;</span><span class="p">,</span>
          <span class="s2">&quot;infrastructure operator&quot;</span><span class="p">,</span>
          <span class="s2">&quot;service provider&quot;</span><span class="p">,</span>
          <span class="s2">&quot;device owner&quot;</span><span class="p">,</span>
          <span class="s2">&quot;system integrator&quot;</span><span class="p">,</span>
          <span class="s2">&quot;devOps&quot;</span><span class="p">,</span>
          <span class="s2">&quot;superUser&quot;</span>
          <span class="p">]</span>
      <span class="p">},</span>
      <span class="s2">&quot;accessLevel&quot;</span> <span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
      <span class="s2">&quot;status&quot;</span> <span class="p">:</span> <span class="s2">&quot;active&quot;</span>
    <span class="p">})</span>
</pre></div>
</div>
</div></blockquote>
<ul>
<li><p class="first">Then update them as follows. Remember to replace the id with ObjectId(” ID OF THE NEW ORGANISATION OR USER “) that you obtained in the previous step:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>db.useraccounts.update(
  {cid: &quot;admin-test&quot;},
  {$set: {
       &quot;accountOf&quot; : [ {
        &quot;id&quot; : &lt; OBTAINED WHEN INSERTING &gt;,
        &quot;extid&quot; : &quot;admin@admin.com&quot;
       }
    ]}
  })
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>db.useraccounts.update(
  {email : &quot;admin@admin.com&quot;},
  {$set: {
       &quot;cid&quot; : {
           &quot;id&quot; : &lt; OBTAINED WHEN INSERTING &gt;,
           &quot;extid&quot; : &quot;admin-test&quot;
           }
        }
    })
</pre></div>
</div>
</li>
</ul>
<ol class="arabic simple" start="2">
<li>Once the db is ready replace in the package JSON the script test with the following:</li>
</ol>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="s2">&quot;env=test VCNT_MNGR_DB=mongodb://test:test@ &lt; YOUR IP or LOCALHOST &gt; :27017/nmapitest nyc mocha &#39;./test/**/*.spec.js&#39;&quot;</span>
</pre></div>
</div>
</div></blockquote>
<ol class="arabic simple" start="3">
<li>Finally, to run the test execute:</li>
</ol>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">npm</span> <span class="n">run</span> <span class="n">test</span>
</pre></div>
</div>
</div></blockquote>
</div>
<hr class="docutils" />
<div class="section" id="complexity">
<h3>Complexity<a class="headerlink" href="#complexity" title="Permalink to this headline">¶</a></h3>
<p>Measures the complexity of the code. It is based on the cyclomatic complexity of the functions among other measurements.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This functionality is available for the server only. (Navigate to the server root folder to execute the scripts that you will find below)</p>
</div>
<ul>
<li><p class="first">Run at module level:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">npm</span> <span class="n">run</span> <span class="n">complexity</span>
</pre></div>
</div>
</li>
<li><p class="first">Run at function level. Highlights the most complex functions per module:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">npm</span> <span class="n">run</span> <span class="n">complexity</span><span class="o">-</span><span class="n">detail</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<hr class="docutils" />
<div class="section" id="f-a-q">
<h2>F.A.Q<a class="headerlink" href="#f-a-q" title="Permalink to this headline">¶</a></h2>
<p><em>Frequent asked questions section</em></p>
<p>Find information about how to resolve common issues or use certain functionalities. This section can be updated with platform users feedback.</p>
<hr class="docutils" />
<div class="section" id="how-can-i-recover-my-password">
<h3>How can I recover my password?<a class="headerlink" href="#how-can-i-recover-my-password" title="Permalink to this headline">¶</a></h3>
<p>It is not possible to send you your old password for security reasons, however we can help you reset your password following a series of simple steps:</p>
<ol class="arabic simple">
<li>Navigate to the login page and click “recover password”</li>
</ol>
<img alt="https://github.com/vicinityh2020/vicinity-neighbourhood-manager/wiki/Images/img-login-pwd.png" src="https://github.com/vicinityh2020/vicinity-neighbourhood-manager/wiki/Images/img-login-pwd.png" />
<ol class="arabic simple" start="2">
<li>Introduce your mail address and send the request for new password</li>
</ol>
<img alt="https://github.com/vicinityh2020/vicinity-neighbourhood-manager/wiki/Images/img-change-pwd-accept.png" src="https://github.com/vicinityh2020/vicinity-neighbourhood-manager/wiki/Images/img-change-pwd-accept.png" />
<ol class="arabic simple" start="3">
<li>Go to your mail and follow the link for changing your password</li>
</ol>
<img alt="https://github.com/vicinityh2020/vicinity-neighbourhood-manager/wiki/Images/img-mail-pwd.png" src="https://github.com/vicinityh2020/vicinity-neighbourhood-manager/wiki/Images/img-mail-pwd.png" />
<ol class="arabic simple" start="4">
<li>Change the password and you are all set</li>
</ol>
</div>
<hr class="docutils" />
<div class="section" id="how-can-i-change-my-password">
<h3>How can I change my password?<a class="headerlink" href="#how-can-i-change-my-password" title="Permalink to this headline">¶</a></h3>
<p>It is possible to change your password using the user interface. To do so, follow these steps:</p>
<ol class="arabic simple">
<li>Navigate to the user profile</li>
</ol>
<img alt="_images/img-user-profile.png" src="_images/img-user-profile.png" />
<ol class="arabic simple" start="2">
<li>Click on edit password</li>
</ol>
<img alt="_images/img-user-profile-pwd-unclicked.png" src="_images/img-user-profile-pwd-unclicked.png" />
<ol class="arabic simple" start="3">
<li>Change and submit your new password.</li>
</ol>
<img alt="_images/img-user-profile-pwd-clicked.png" src="_images/img-user-profile-pwd-clicked.png" />
</div>
<hr class="docutils" />
<div class="section" id="can-i-keep-a-session-open-in-my-browser">
<h3>Can I keep a session open in my browser?<a class="headerlink" href="#can-i-keep-a-session-open-in-my-browser" title="Permalink to this headline">¶</a></h3>
<p>If you want to keep open your session and avoid typing your password every time, we can do that for you. Just check the box highlighted in the picture. <em>Use this feature responsibly and preferably only in your personal computer to prevent unauthorised access to your account!</em></p>
<img alt="_images/img-remember-me.png" class="align-center" src="_images/img-remember-me.png" />
</div>
<hr class="docutils" />
<div class="section" id="how-can-i-use-the-platform-rest-api">
<h3>How can I use the platform REST API?<a class="headerlink" href="#how-can-i-use-the-platform-rest-api" title="Permalink to this headline">¶</a></h3>
<p>The platform offers a way to programatically use some of its functionalities. Thus developers can build their own value added services or user interfaces using the platform backend.</p>
<p>Everyone with a valid organisation registered can use the API and all the documentation is available following the link below:</p>
<p><a class="reference external" href="https://vicinityh2020.github.io/vicinity-neighbourhood-manager-api/">API Documentation</a></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="vocabulary.html" class="btn btn-neutral float-right" title="VICINITY Vocabulary" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="architecture.html" class="btn btn-neutral" title="VICINITY Overall architecture" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Viktor Oravec

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>